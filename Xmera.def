BootStrap: docker
From: ubuntu:xenial

%environment
    export PATH=/miniconda3/bin:$PATH

%runscript
    exec vcontact "$@"

%post
    apt-get update && apt-get install -y \
    automake \
    build-essential \
    bzip2 \
    wget \
    git \
    default-jre \
    unzip

    # Install miniconda 
    wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
    bash Miniconda3-latest-Linux-x86_64.sh -b -f -p /miniconda3/
    rm Miniconda3-latest-Linux-x86_64.sh

    # pull the conda functions in . /miniconda3/etc/profile.d/conda.sh and make pip, etc. available while in %post
    export PATH="/miniconda3/bin:$PATH"

    # Use conda to install pip, numpy
    conda install -y -c conda-forge pip numpy pandas

    # Help conda resolving Python "import" 
    conda update --all

    # create virtual environment
    python3 -m venv env
    chmod -R 777 /app/
    source env/bin/activate


    # Install fuzzywuzzy
    pip install fuzzywuzzy
    pip install fuzzywuzzy[speedup]
